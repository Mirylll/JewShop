@using Microsoft.AspNetCore.Components.Authorization
@inject IAuthService AuthService
@inject NavigationManager Navigation

<div class="main-header">
    <div class="wrapper">
        
        <div class="left" @onclick='() => Navigation.NavigateTo("/")'>
            <img src="assets/icons/logo.png" onerror="this.src='https://via.placeholder.com/40'" alt="Logo" class="logo" />
            <span class="brand-name">JewShop</span>
        </div>

        <div class="center">
            <nav class="nav-menu">
                <a href="/products/rings">Rings</a>
                <a href="/products/earrings">Earrings</a>
                <a href="/products/necklaces">Necklaces</a>
                <a href="/products/bracelets">Bracelets</a>
                <a href="/products/pendants">Pendants</a>
                <a href="/products/anklets">Anklets</a>
                <a href="/products/accessories">Accessories</a>
            </nav>
        </div>

        <div class="right">
            <div class="search-box">
                <input type="text" placeholder="Search..." />
                <span class="search-icon">🔍</span>
            </div>

            <a href="/cart" class="cart-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>
            </a>

            <AuthorizeView>
                <Authorized>
                    <div class="avatar-menu">
                        <img src="https://ui-avatars.com/api/?name=@context.User.Identity?.Name&background=0D8ABC&color=fff" class="avatar" />
                        
                        <div class="dropdown">
                            <div class="dropdown-header">
                                Xin chào, <strong>@context.User.Identity?.Name</strong>
                            </div>
                            
                            <a href="/profile" class="dropdown-item">
                                Hồ sơ cá nhân
                            </a>
                            
                            <div class="dropdown-divider"></div>
                            
                            <div class="dropdown-item text-danger" @onclick="Logout">
                                Đăng xuất
                            </div>
                        </div>
                    </div>
                </Authorized>
                <NotAuthorized>
                    <div class="auth-buttons">
                        <a href="/login" class="btn-login">Login</a>
                    </div>
                </NotAuthorized>
            </AuthorizeView>
        </div>
    </div>
</div>

@code {
    private async Task Logout()
    {
        await AuthService.Logout();
       
        Navigation.NavigateTo("/login", forceLoad: true);
    }
}